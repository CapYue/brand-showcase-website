# 📊 业务流程文档

## 目录
1. [核心业务流程](#核心业务流程)
2. [用户使用流程](#用户使用流程)
3. [管理员操作流程](#管理员操作流程)
4. [数据流向](#数据流向)
5. [异常处理流程](#异常处理流程)
6. [系统集成流程](#系统集成流程)

---

## 核心业务流程

### 流程 1: 用户浏览官网

```
用户输入网址
    ↓
浏览器加载首页 (/)
    ↓
前端应用初始化 (React App)
    ↓
加载首页组件 (HomePage)
    ↓
┌─────────────────────────────┐
│  调用多个 API 获取数据       │
├─────────────────────────────┤
│ 1. GET /api/v1/banners      │
│ 2. GET /api/v1/company/info │
│ 3. GET /api/v1/products     │
│ 4. GET /api/v1/news         │
│ 5. GET /api/v1/certifications
└─────────────────────────────┘
    ↓
┌──────────────────────────────┐
│  后端 API 响应               │
├──────────────────────────────┤
│ - 轮播数据                   │
│ - 企业信息                   │
│ - 产品列表                   │
│ - 新闻列表                   │
│ - 资质荣誉                   │
└──────────────────────────────┘
    ↓
前端渲染页面
    ├─ 轮播区
    ├─ 企业简介
    ├─ 产品展示
    ├─ 新闻动态
    ├─ 资质荣誉
    └─ 页脚
    ↓
用户看到完整首页
```

**涉及模块:**
- 前端: HomePage, Navbar, Banner, About, Products, News, Certifications, Footer
- 后端: GET /api/v1/* (所有公开数据接口)
- 数据: 轮播、企业信息、产品、新闻、资质

---

### 流程 2: 浏览产品列表和详情

```
用户点击导航栏 "产品中心"
    ↓
跳转到 /products 页面
    ↓
ProductsPage 组件加载
    ↓
GET /api/v1/products  获取产品列表
    ↓
后端返回所有产品数据
    ↓
前端显示产品网格
    ├─ 产品卡片 (名称、图片、价格)
    ├─ 分类筛选菜单
    └─ 搜索框
    ↓
用户操作选项:
├─ 按分类筛选 → 更新列表
├─ 搜索产品 → 过滤显示
├─ 点击产品 → 进入详情页
│  ├─ URL 变为 /products/:id
│  ├─ GET /api/v1/products/:id
│  └─ 显示产品详情 (完整信息、特性、对比)
│
└─ 返回列表 → 回到产品列表
```

**涉及模块:**
- 前端: ProductsPage, Products, ProductDetailPage
- 后端: GET /api/v1/products, GET /api/v1/products/:id
- 数据: 产品信息

---

### 流程 3: 阅读新闻

```
用户点击导航栏 "新闻动态"
    ↓
跳转到 /news 页面
    ↓
NewsPage 组件加载
    ↓
GET /api/v1/news?page=1&pageSize=10  获取新闻列表
    ↓
后端返回分页新闻数据
    ↓
前端显示新闻列表
    ├─ 新闻项目 (标题、日期、摘要)
    ├─ 分页控件
    ├─ 日期筛选
    └─ 分类筛选
    ↓
用户操作选项:
├─ 翻页 → 加载下一页
├─ 筛选日期 → 显示特定日期新闻
├─ 筛选类型 → 企业新闻/行业动态
├─ 点击新闻 → 进入新闻详情页
│  ├─ URL 变为 /news/:id
│  ├─ GET /api/v1/news/:id
│  └─ 显示新闻全文 (标题、日期、内容、图片)
│
└─ 返回列表 → 回到新闻列表
```

**涉及模块:**
- 前端: NewsPage, News, NewsDetailPage
- 后端: GET /api/v1/news, GET /api/v1/news/:id
- 数据: 新闻信息

---

### 流程 4: 提交联系表单

```
用户点击导航栏 "联系我们"
    ↓
跳转到 /contact 页面
    ↓
ContactPage 组件加载
    ↓
显示联系表单
    ├─ 姓名输入框
    ├─ 邮箱输入框
    ├─ 电话输入框
    ├─ 内容文本域
    └─ 提交按钮
    ↓
用户填写表单
    ↓
用户点击提交
    ↓
前端验证表单
    ├─ 检查必填项
    ├─ 检查邮箱格式
    ├─ 检查电话格式
    └─ 检查内容长度
    ↓
验证成功 ✓
    ├─ 显示加载状态
    ├─ POST /api/v1/contact { name, email, phone, message }
    ↓
后端接收请求
    ├─ 验证数据
    ├─ 保存到数据库/文件
    ├─ 发送确认邮件 (可选)
    └─ 返回成功响应
    ↓
前端显示成功提示
    ├─ 显示 "提交成功" 消息
    ├─ 表单自动重置
    └─ 3秒后自动关闭
    ↓
用户看到确认信息

或

验证失败 ✗
    ↓
显示错误提示
    ↓
用户修改表单
    ↓
重新提交
```

**涉及模块:**
- 前端: ContactPage, Contact
- 后端: POST /api/v1/contact
- 数据: 联系表单数据

---

### 流程 5: 查看企业信息

```
用户点击导航栏 "关于我们"
    ↓
跳转到 /about 页面
    ↓
AboutPage 组件加载
    ↓
GET /api/v1/company/info  获取企业详细信息
    ↓
后端返回企业数据
    ├─ 企业简介
    ├─ 核心价值
    ├─ 发展历程
    └─ 团队成员
    ↓
前端显示企业页面
    ├─ 企业简介文案
    ├─ 核心价值卡片 (4 个核心价值)
    ├─ 发展历程时间轴
    ├─ 团队成员卡片
    └─ 企业文化视频
    ↓
用户了解企业信息
```

**涉及模块:**
- 前端: AboutPage, About
- 后端: GET /api/v1/company/info
- 数据: 企业信息

---

### 流程 6: 查看技术实力

```
用户点击导航栏 "技术实力"
    ↓
跳转到 /technology 页面
    ↓
TechnologyPage 组件加载
    ↓
GET /api/v1/certifications  获取资质和认证
    ↓
后端返回资质数据
    ├─ 国际认证 (ISO系列)
    ├─ 安全认证
    ├─ 政府认证
    ├─ 专利证书
    └─ 行业奖项
    ↓
前端显示资质页面
    ├─ 资质卡片网格
    ├─ 按分类筛选
    ├─ 按重要程度排序
    └─ 显示获得年份
    ↓
用户了解企业资质
```

**涉及模块:**
- 前端: TechnologyPage, Certifications
- 后端: GET /api/v1/certifications
- 数据: 资质荣誉

---

## 用户使用流程

### 普通访客流程

```
新用户
    ↓
输入网址 → 首页
    ↓
浏览关键内容
    ├─ 轮播 → 了解品牌
    ├─ 产品 → 了解产品线
    ├─ 新闻 → 了解最新动态
    └─ 资质 → 了解企业实力
    ↓
有兴趣
    ├─ 点击产品 → 详细了解
    ├─ 阅读新闻 → 获取信息
    └─ 了解公司 → 增强信任
    ↓
产生询问
    ↓
填写联系表单
    ↓
提交成功
    ↓
企业回复
```

---

## 管理员操作流程

### 流程 1: 产品管理

```
管理员登录系统
    ↓
进入 /admin 管理后台
    ↓
选择 "产品管理"
    ↓
┌──────────────────────────────┐
│  查看产品列表                  │
│  GET /api/admin/products     │
└──────────────────────────────┘
    ↓
显示产品表格
    ├─ 产品名称
    ├─ 分类
    ├─ 价格
    ├─ 操作按钮 (编辑、删除)
    └─ 新增按钮
    ↓
管理员操作选择:

├─ 【新增产品】
│  ├─ 点击 "新增" 按钮
│  ├─ 打开编辑表单
│  ├─ 填写产品信息
│  │  ├─ 产品名称 (必填)
│  │  ├─ 分类 (必填)
│  │  ├─ 图片 URL (必填)
│  │  ├─ 描述 (必填)
│  │  ├─ 价格 (必填)
│  │  └─ 特性列表 (必填)
│  ├─ 点击 "保存"
│  ├─ 前端验证数据
│  ├─ POST /api/admin/products { 产品数据 }
│  ├─ 后端保存数据
│  ├─ 返回成功响应
│  ├─ 显示成功提示
│  └─ 表单关闭，列表刷新
│
├─ 【编辑产品】
│  ├─ 点击某产品的 "编辑" 按钮
│  ├─ 打开编辑表单，预填充现有数据
│  ├─ 修改产品信息
│  ├─ 点击 "保存"
│  ├─ 前端验证数据
│  ├─ PUT /api/admin/products/:id { 新数据 }
│  ├─ 后端更新数据
│  ├─ 返回成功响应
│  ├─ 显示成功提示
│  └─ 表单关闭，列表刷新
│
└─ 【删除产品】
   ├─ 点击某产品的 "删除" 按钮
   ├─ 显示确认对话框 "确定删除？"
   ├─ 管理员确认删除
   ├─ DELETE /api/admin/products/:id
   ├─ 后端删除数据
   ├─ 返回成功响应
   ├─ 显示成功提示
   └─ 列表刷新，删除的产品消失
```

**涉及 API:**
- GET /api/admin/products
- POST /api/admin/products
- PUT /api/admin/products/:id
- DELETE /api/admin/products/:id

---

### 流程 2: 新闻管理

```
管理员在后台
    ↓
选择 "新闻管理"
    ↓
GET /api/admin/news  获取新闻列表
    ↓
显示新闻表格
    ├─ 新闻标题
    ├─ 新闻类型
    ├─ 发布日期
    ├─ 操作按钮 (编辑、删除)
    └─ 新增按钮
    ↓
管理员操作选择:

├─ 【创建新闻】
│  ├─ 点击 "新增" 按钮
│  ├─ 打开编辑表单
│  ├─ 填写新闻信息
│  │  ├─ 新闻标题 (必填)
│  │  ├─ 新闻类型 (必填)
│  │  ├─ 摘要 (必填)
│  │  ├─ 完整内容 (必填)
│  │  ├─ 特征图 (可选)
│  │  └─ 发布日期 (自动当前时间)
│  ├─ 点击 "保存"
│  ├─ 前端验证数据
│  ├─ POST /api/admin/news { 新闻数据 }
│  ├─ 后端保存数据
│  ├─ 返回成功响应
│  ├─ 显示成功提示
│  └─ 表单关闭，列表刷新
│
├─ 【编辑新闻】
│  ├─ 点击某新闻的 "编辑" 按钮
│  ├─ 打开编辑表单，预填充现有数据
│  ├─ 修改新闻内容
│  ├─ 点击 "保存"
│  ├─ 前端验证数据
│  ├─ PUT /api/admin/news/:id { 新数据 }
│  ├─ 后端更新数据
│  ├─ 返回成功响应
│  ├─ 显示成功提示
│  └─ 表单关闭，列表刷新
│
└─ 【删除新闻】
   ├─ 点击某新闻的 "删除" 按钮
   ├─ 显示确认对话框
   ├─ 管理员确认删除
   ├─ DELETE /api/admin/news/:id
   ├─ 后端删除数据
   ├─ 返回成功响应
   ├─ 显示成功提示
   └─ 列表刷新，删除的新闻消失
```

**涉及 API:**
- GET /api/admin/news
- POST /api/admin/news
- PUT /api/admin/news/:id
- DELETE /api/admin/news/:id

---

### 流程 3: 资质管理

```
管理员在后台
    ↓
选择 "资质管理"
    ↓
GET /api/admin/certifications  获取资质列表
    ↓
显示资质表格
    ├─ 资质名称
    ├─ 分类
    ├─ 重要程度
    ├─ 获得年份
    ├─ 操作按钮
    └─ 新增按钮
    ↓
管理员操作选择:

├─ 【新增资质】
│  ├─ 点击 "新增"
│  ├─ 打开表单
│  ├─ 填写信息
│  │  ├─ 资质名称
│  │  ├─ 分类 (国际认证/安全认证/政府认证等)
│  │  ├─ 证书图片 URL
│  │  ├─ 重要程度 (1-10)
│  │  └─ 获得年份
│  ├─ POST /api/admin/certifications
│  └─ 保存成功
│
├─ 【编辑资质】
│  ├─ 点击 "编辑"
│  ├─ 修改信息
│  ├─ PUT /api/admin/certifications/:id
│  └─ 保存成功
│
└─ 【删除资质】
   ├─ 点击 "删除"
   ├─ DELETE /api/admin/certifications/:id
   └─ 删除成功
```

**涉及 API:**
- GET /api/admin/certifications
- POST /api/admin/certifications
- PUT /api/admin/certifications/:id
- DELETE /api/admin/certifications/:id

---

### 流程 4: 文件上传

```
管理员上传产品图片
    ↓
在编辑表单中点击 "上传图片"
    ↓
选择本地图片文件
    ↓
前端校验
    ├─ 检查文件类型 (仅允许 jpeg|jpg|png|gif|webp)
    └─ 检查文件大小 (≤5MB)
    ↓
校验通过
    ↓
显示上传进度
    ↓
POST /api/admin/upload { 文件 }
    ↓
后端接收文件
    ├─ 再次校验文件
    ├─ 生成唯一文件名 (timestamp + random)
    ├─ 保存到 public/uploads/ 目录
    └─ 返回访问 URL
    ↓
前端获得 URL
    ├─ 显示上传完成
    ├─ 将 URL 填充到表单
    └─ 预览上传的图片
    ↓
管理员保存表单
    ↓
图片永久保存
```

**涉及 API:**
- POST /api/admin/upload

---

## 数据流向

### 数据入口

```
数据来源
├─ 管理员输入 (后台表单)
├─ 文件上传 (图片、Excel)
├─ API 集成 (外部系统)
└─ 系统初始化 (默认数据)
```

### 数据处理流程

```
原始数据
    ↓
数据验证
    ├─ 格式校验 (类型、长度)
    ├─ 内容校验 (非空、范围)
    └─ 关系校验 (外键、唯一性)
    ↓
验证通过 ✓
    ├─ 数据处理 (清理、转换)
    ├─ 数据存储 (数据库/文件)
    ├─ 更新缓存
    └─ 发送通知
    ↓
验证失败 ✗
    ├─ 返回错误信息
    └─ 管理员重新输入

用户展示
    ↓
前端获取数据
    ├─ 调用 API
    ├─ 缓存数据
    └─ 渲染页面
    ↓
用户查看页面
```

### 数据存储架构

```
数据持久化
├─ JSON 文件 (当前开发方案)
│  ├─ public/config.json       (所有网站数据)
│  ├─ public/config-dev.json   (开发环境)
│  └─ public/uploads/          (上传的文件)
│
└─ 真实数据库 (生产方案)
   ├─ MySQL
   ├─ MongoDB
   └─ PostgreSQL
```

### 数据流动图

```
后端 websiteData (内存)
    ↓
读写操作
    ├─ GET → 返回数据给前端
    ├─ POST → 保存新数据
    ├─ PUT → 更新现有数据
    └─ DELETE → 删除数据
    ↓
存储到文件 (可选持久化)
    ├─ 服务器重启后重新加载
    └─ 数据永久保留

前端展示
    ├─ 获取数据后缓存在内存
    ├─ 用户操作触发数据更新
    ├─ 需要时重新请求 API
    └─ Mock 数据作为备用
```

---

## 异常处理流程

### 异常 1: API 请求失败

```
前端调用 API
    ↓
┌──────────────────────┐
│ 后端响应是否正常？    │
└──────────────────────┘
    ├─ 是 ✓
    │  └─ 返回数据，页面正常显示
    │
    └─ 否 ✗
       ├─ 网络错误
       ├─ 超时 (>30秒)
       ├─ 服务器错误 (500)
       ├─ 未授权 (401)
       └─ 未找到 (404)
           ↓
       前端捕获错误
           ↓
       检查是否有 Mock 数据
           ├─ 是 ✓ → 使用 Mock 数据，降级显示内容
           └─ 否 ✗ → 显示错误提示 "加载失败，请稍后重试"
           ↓
       用户仍可继续浏览
```

**处理代码 (apiClient.js):**
```javascript
async request(endpoint, options = {}) {
    try {
        const response = await fetch(`${this.baseUrl}${endpoint}`, {
            ...options,
            timeout: 30000  // 30秒超时
        })
        if (response.ok) {
            return response.json()
        }
        throw new Error(`HTTP ${response.status}`)
    } catch (error) {
        console.error('API Error:', error)
        // 返回 Mock 数据作为降级方案
        return this.getFallbackData(endpoint)
    }
}
```

---

### 异常 2: 表单验证失败

```
用户提交表单
    ↓
前端验证
├─ 必填项检查
├─ 格式检查 (邮箱、电话、URL)
├─ 长度限制
└─ 业务规则检查
    ↓
验证失败 ✗
    ├─ 显示错误信息
    ├─ 高亮错误字段
    └─ 焦点移到第一个错误字段
    ↓
用户修正后重新提交
    ↓
验证通过 ✓
    ├─ 提交到后端
    └─ 等待响应
```

---

### 异常 3: 后端数据库错误

```
后端处理请求
    ↓
执行数据库操作
    ↓
出现错误
├─ 数据库连接失败
├─ 违反唯一约束
├─ 数据不存在
└─ SQL 查询错误
    ↓
后端错误处理
├─ 捕获异常
├─ 记录错误日志
├─ 构建错误响应
│  ├─ 隐藏系统细节 (不暴露 SQL 错误)
│  └─ 返回用户友好的错误消息
└─ 发送到前端
    ↓
前端显示错误提示
    ├─ "操作失败，请稍后重试"
    └─ 建议管理员检查日志
```

---

### 异常 4: 文件上传失败

```
管理员上传文件
    ↓
前端校验
├─ 文件类型检查
└─ 文件大小检查
    ↓
校验失败 ✗
    ├─ 显示错误提示
    │  ├─ "只支持 JPG、PNG 等图片格式"
    │  ├─ "文件大小不能超过 5MB"
    │  └─ "请重新选择文件"
    └─ 不发送请求
    ↓
用户重新选择
    ↓
校验通过 ✓
    ├─ 发送到后端
    └─ 等待响应
    ↓
┌────────────────┐
│ 后端再次校验   │
└────────────────┘
    ├─ 通过 ✓
    │  ├─ 保存文件
    │  ├─ 生成 URL
    │  └─ 返回成功
    │
    └─ 失败 ✗
       ├─ 磁盘空间不足
       ├─ 权限问题
       └─ 返回错误提示
```

---

## 系统集成流程

### 集成 1: OAuth 登录 (可选)

```
前端集成 OAuth
    ├─ 添加第三方登录按钮 (Google、GitHub)
    ├─ 重定向到认证服务器
    └─ 获取 Token
    ↓
后端验证 Token
    ├─ 检查 Token 有效性
    ├─ 获取用户信息
    └─ 创建会话
    ↓
前端保存 Token
    ├─ localStorage 中保存
    ├─ 后续请求时携带
    └─ 认证完成
```

---

### 集成 2: 邮件通知 (可选)

```
用户提交联系表单
    ↓
后端接收表单
    ├─ 验证数据
    ├─ 保存到数据库
    └─ 触发邮件服务
    ↓
邮件服务
    ├─ 发送确认邮件给用户
    │  └─ "您的邮件已收到，我们会尽快回复"
    └─ 发送通知邮件给企业
       └─ "有新的用户咨询"
    ↓
前端显示成功
    └─ "您的信息已提交，我们会尽快联系您"
```

---

### 集成 3: CDN 加速 (可选)

```
静态资源（图片、JS、CSS）
    ↓
上传到 CDN
    ├─ 阿里云 OSS
    ├─ AWS CloudFront
    └─ 七牛云
    ↓
更新资源 URL
    ├─ API 返回 CDN URL
    └─ 前端使用 CDN 地址
    ↓
用户下载资源
    ├─ 从最近的 CDN 节点获取
    ├─ 加速网页加载
    └─ 降低服务器带宽
```

---

### 集成 4: 搜索引擎优化 SEO

```
前端页面加载
    ↓
updateMetaTags() 更新 Meta 标签
    ├─ 设置 title (页面标题)
    ├─ 设置 description (页面描述)
    ├─ 设置 keywords (关键词)
    ├─ 设置 Open Graph (社交分享)
    └─ 设置 canonical (规范 URL)
    ↓
后端支持
    ├─ 返回结构化数据 (Schema.json)
    ├─ 提供 Sitemap
    └─ 配置 robots.txt
    ↓
搜索引擎爬虫
    ├─ 抓取页面内容
    ├─ 索引收录
    └─ 提高排名
```

---

## 流程图总结

### 用户旅程地图

```
访客来源
    ├─ 搜索引擎
    ├─ 直接输入
    ├─ 社交媒体
    └─ 推荐链接
        ↓
    进入首页
        ├─ 看轮播 (品牌认知)
        ├─ 看简介 (企业信任)
        ├─ 看产品 (产品兴趣)
        └─ 看新闻 (企业活力)
        ↓
    产生兴趣
        ├─ 浏览产品详情
        ├─ 阅读新闻文章
        ├─ 了解技术实力
        └─ 查看企业信息
        ↓
    产生转化
        ├─ 联系咨询
        ├─ 索取资料
        ├─ 预约演示
        └─ 在线订购 (可选)
        ↓
    成为客户
        ├─ 初次成交
        ├─ 长期合作
        └─ 口碑传播
```

### 管理员工作流程

```
登录系统
    ↓
选择管理模块
├─ 产品管理
├─ 新闻管理
├─ 资质管理
├─ 企业信息
└─ 文件管理
    ↓
执行 CRUD 操作
    ├─ 创建 (Create)
    ├─ 读取 (Read)
    ├─ 更新 (Update)
    └─ 删除 (Delete)
    ↓
保存数据
    ├─ 发送 API 请求
    ├─ 后端验证和保存
    └─ 返回结果
    ↓
确认操作
    ├─ 查看列表刷新
    └─ 确认数据已保存
```

